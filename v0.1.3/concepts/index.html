<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Concepts · FreudenthalTriangulations.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">FreudenthalTriangulations.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Table of Contents</span><ul><li><a class="tocitem" href="../">FreudenthalTriangulations.jl</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li class="is-active"><a class="tocitem" href>Concepts</a><ul class="internal"><li><a class="tocitem" href="#Freudenthal-Triangulation"><span>Freudenthal Triangulation</span></a></li><li><a class="tocitem" href="#Freudenthal-Simplex-and-Barycentric-Coordinates"><span>Freudenthal Simplex and Barycentric Coordinates</span></a></li><li><a class="tocitem" href="#Example-of-Freudenthal-Interpolation"><span>Example of Freudenthal Interpolation</span></a></li><li><a class="tocitem" href="#Belief-Space-Interpolation"><span>Belief Space Interpolation</span></a></li><li><a class="tocitem" href="#Example-of-Freudenthal-Discretization-of-a-Belief-Space"><span>Example of Freudenthal Discretization of a Belief Space</span></a></li><li><a class="tocitem" href="#Example-of-Policy-and-Value-Function-for-Manufacture-Problem"><span>Example of Policy and Value Function for Manufacture Problem</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Table of Contents</a></li><li class="is-active"><a href>Concepts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Concepts</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sisl/FreudenthalTriangulations.jl/blob/master/docs/src/concepts.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Concepts"><a class="docs-heading-anchor" href="#Concepts">Concepts</a><a id="Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Concepts" title="Permalink"></a></h1><h2 id="Freudenthal-Triangulation"><a class="docs-heading-anchor" href="#Freudenthal-Triangulation">Freudenthal Triangulation</a><a id="Freudenthal-Triangulation-1"></a><a class="docs-heading-anchor-permalink" href="#Freudenthal-Triangulation" title="Permalink"></a></h2><p>Freudenthal triangulation of a continuous space produces a set of vertices with integer coordinates. If we are working in an <span>$n$</span> dimensional space with a granularity of <span>$m &gt; 0$</span>, then we will get a set of vertices of the form <span>$[v_1, v_2, \dots, v_n]$</span> where <span>$m = v_1 \ge v_2 \ge \cdots \ge v_n \ge 0$</span>.</p><p>One example of a Freudenthal triangulation with <code>n = 3</code> and <code>m = 3</code> is shown below. Note that <span>$v_1$</span> is always <code>3</code> so the diagram only shows <span>$v_2$</span> and <span>$v_3.$</span></p><p align=center><img src="../figures/triangulation.svg" alt="triangulation" width=275/></p><p>Thus the vertices of the Freudenthal discretization of a 3-dimensional space with <span>$m=3$</span> has 10 vertices:</p><p class="math-container">\[\begin{Bmatrix} [3,0,0] &amp; [3,1,0] &amp; [3,2,0] &amp; [3,3,0] \\  &amp; [3,1,1] &amp; [3,2,1] &amp; [3,3,1] \\ &amp; &amp; [3,2,2] &amp; [3,3,2] \\ &amp; &amp; &amp; [3,3,3] \end{Bmatrix}\]</p><p>In general, we can see that there are <span>$\frac{(m+n-1)!}{m!(n-1)!}$</span> vertices. This is because we can consider the sequence <span>$u_2, u_3, \dots, u_n$</span> where <span>$u_i = v_i + (n - i)$</span> for all <span>$2 \le i \le n.$</span> Then we must have that since <span>$v_i \ge v_{i+1}$</span> for <span>$2 \le i \le n-1$</span>, this means that <span>$u_i &gt; u_{i+1}$</span>. We also see that since <span>$v_2 \le m$</span>, this means that <span>$u_2 \le m + n - 2$</span> and since <span>$v_n \ge 0$</span>, this means that <span>$u_2 \ge 0$</span>. Therefore, to count the number of vertices in a Freudenthal Triangulation, we must just select <span>$n-1$</span> distinct integers in the range <span>$[0, m+n-2]$</span> and this will correspond to a unique sequence <span>$u_2, u_3, \dots, u_n$</span> and thus it corresponds to a unique vertex <span>$[v_1, v_2, \dots, v_n]$</span> where <span>$m = v_1 \ge v_2 \ge \dots \ge v_n \ge 0.$</span> Thus there are <span>$\binom{m+n-1}{n-1} = \frac{(m+n-1)!}{m!}{(n-1)!}$</span> vertices in a Freudenthal triangulation of an <span>$n$</span>-dimensional space with granularity <span>$m$</span>.</p><p>The number of beliefs in the Freudenthal triangulation for beliefs over <span>$n$</span> discrete states as a function of the granularity <span>$m$</span> is shown in the figure below</p><p align=center><img src="../figures/num_triangulations.svg" alt="Number of triangulation" width=275/></p><h2 id="Freudenthal-Simplex-and-Barycentric-Coordinates"><a class="docs-heading-anchor" href="#Freudenthal-Simplex-and-Barycentric-Coordinates">Freudenthal Simplex and Barycentric Coordinates</a><a id="Freudenthal-Simplex-and-Barycentric-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Freudenthal-Simplex-and-Barycentric-Coordinates" title="Permalink"></a></h2><p>If we know the values of a function <span>$f$</span> at the integer Freudenthal vertices, we can use triangulation to estimate the value at an arbitrary point <span>$x$</span> from the <span>$n+1$</span> vertices of the simplex enclosing <span>$x$</span>:</p><p class="math-container">\[f(x) = \sum_{i = 1}^{n+1} \lambda_i f(v^{(i)})\]</p><p>where the vertices of the simplex containing <span>$x$</span> are <span>$v^{(1)}, \dots, v^{(n+1)}$</span>. The scalars <span>$\lambda_i$</span> are barycentric coordinates of <span>$x$</span> with respect to the simplex vertices. Recall that barycentric coordinates are non-negative weights that sum to <span>$1$</span> such that <span>$x = \sum_{i = 1}^{n+1}\lambda_i v^{(i)}$</span>.</p><p>To find the coordinates of the simplex containing <span>$x$</span>, we set the first vertex <span>$v^{(1)} = [\lfloor x_1 \rfloor, \lfloor x_2 \rfloor, \dots, \lfloor x_n \rfloor]$</span> where <span>$\lfloor a \rfloor$</span> is the greatest integer less than or equal to <span>$a$</span>.</p><p>We then compute <span>$d = x - v^{(1)}$</span> and sort the components of <span>$d$</span> in descending order <span>$d_{p_1} \ge d_{p_2} \ge \dots \ge d_{p_n}$</span> where <span>$p$</span> is a permutation of <code>1:n</code>. From here the remaining simplex vertices can be constructed as <span>$v^{(k+1)} = v^{(k)} + e_{p_k}$</span> where <span>$e_i$</span> is the <span>$i$</span>th standard basis vector.</p><p>As an example suppose we wanted to find the simplex vertices for the Freudenthal triangulation of <span>$x = [1.2, -3.4, 2]$</span>. The first vertex is <span>$v^{(1)} = [1, -4, 2]$</span> which means that <span>$d = [0.2, 0.6, 0.0]$</span>. We then arrange the components in descending order, <span>$0.6 \ge 0.2 \ge 0.0$</span> so <span>$p = [2, 1, 3]$</span>. Thus the remaining simplex vertices are:</p><p class="math-container">\[\begin{aligned}
v^{(2)} = [1, -4, 2] + [0,1,0] = [1, -3, 2] \\
v^{(3)} = [1,-3,2] + [1, 0, 0] = [2, -3, 2] \\
v^{(4)} = [2, -3, 2] + [0,0,1] = [2,-3,3].
\end{aligned}\]</p><p>To compute the barycentric coordinates <span>$\lambda$</span>, we set</p><p class="math-container">\[\begin{aligned}
\lambda_{n+1} &amp;= d_{p_n} \\
\lambda_{n} &amp;= d_{p_{n-1}} - d_{p_n} \\
\lambda_{n-1} &amp;= d_{p_{n-2}} - d_{p_{n-1}} \\
\vdots \\
\lambda_{2} &amp;= d_{p_1} - d_{p_2} \\
\lambda_1 &amp;= 1 - \sum_{i=1}^{n+1} \lambda_i.
\end{aligned}\]</p><p>We know that since <span>$d_{p_1} \ge d_{p_2} \ge \dots \ge d_{p_n}$</span> is a decreasing sequence of real numbers between <span>$0$</span> and <span>$1$</span>, this means that <span>$0 \le \lambda_i \le 1$</span> for <span>$1 \le i \le n+1$</span>. We also have that for each coordinate <span>$x_j, 1 \le j \le n$</span>, then</p><p class="math-container">\[\begin{aligned}
\sum_{i=0}^{n+1}\lambda_i v^{(i)}_j = v^{(1)}_j \left(\sum_{i=0}^{n+1} \lambda_i\right) + \sum_{i=j+1}^{n+1}\lambda_i = v^{(1)}_j + d_{p_j} = x_j
\end{aligned}\]</p><p>Thus, we have the barycentric coordinates of <span>$x$</span> with respect to the Freudenthal simplex enclosing <span>$x$</span>.</p><p>We see that in the Freudenthal simplex that we calculated above, the barycentric coordinates are</p><p class="math-container">\[\begin{aligned}
\lambda_4 &amp;= d_{p_3} = 0.0 \\
\lambda_3 &amp;= d_{p_2} - d_{p_3} = 0.2 \\
\lambda_2 &amp;= d_{p_1} - d_{p_2} = 0.4 \\
\lambda_1 &amp;= 1 - \lambda_2 - \lambda_3 - \lambda_4 = 0.4.
\end{aligned}\]</p><p>We see that <span>$[1.2, -3.4, 2] = 0.4 \cdot [1, -4, 2] + 0.4 \cdot [1, -3, 2] + 0.2 \cdot [2, -3, 2] + 0.0 \cdot [2,-3,3]$</span>, confirming that the barycentric coordinates are correct.</p><p>Now using these barycentric coordinates and the vertices of the Freudenthal simplex, we will be able to perform function approximation in Freudenthal space. Specifically, we will approximate <span>$f(x)$</span> as</p><p class="math-container">\[\begin{aligned}
f(x) \approx \sum_{i = 1}^{n+1} f(v^{(i)}) \lambda_i.
\end{aligned}\]</p><h2 id="Example-of-Freudenthal-Interpolation"><a class="docs-heading-anchor" href="#Example-of-Freudenthal-Interpolation">Example of Freudenthal Interpolation</a><a id="Example-of-Freudenthal-Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-Freudenthal-Interpolation" title="Permalink"></a></h2><p>Consider the example of <span>$f(x,y) = \sqrt{(x-1)^2 + (y-1)^2}$</span> defined on the region <span>$R = (0, 4) \times (0,4)$</span>. Then for each point <span>$(x,y) \in R$</span>, we can the Freudenthal simplex which contains <span>$(x,y)$</span>. We see that these simplices are triangles which are either defined by <span>$v^{(1)} = (p, q), v^{(2)} = (p + 1, q), v^{(3)} = (p+1, q+1)$</span> or <span>$v^{(1)} = (p, q), v^{(2)} = (p, q + 1), v^{(3)} = (p+1, q+1)$</span> where <span>$p, q \in \{0, 1, 2, 3\}$</span>. Then we can also find the barycentric coordinates of <span>$(x,y)$</span> in its simplex. Finally, we can use the barycentric coordinates <span>$\lambda_1, \lambda_2, \lambda_3$</span> to approximate the function <span>$f$</span> by</p><p class="math-container">\[\begin{aligned}
f(x) \approx f(v^{(1)}) \lambda_1 + f(v^{(2)}) \lambda_2 + f(v^{(3)}) \lambda_3.
\end{aligned}\]</p><p>For example, we can approximate <span>$f(1, 1.5)$</span> by seeing that it is contained in the simplex with vertices <span>$v^{(1)} = (1, 1), v^{(2)} = (1, 2), v^{(3)} = (2, 2).$</span> Then we also get that the barycentric coordiantes are <span>$\lambda_1 = 0.5, \lambda_2 = 0.5, \lambda_3 = 0.$</span> Therefore, we can approximate <span>$f$</span> at <span>$(1, 1.5)$</span> by</p><p class="math-container">\[\begin{aligned}
f(x) \approx 0.5 \cdot 0 + 0.5 \cdot 1^2 = 0.5
\end{aligned}\]</p><p>which is fairly close to the true value of <span>$0.25$</span>.</p><p>The heatmaps of <span>$f$</span> and its approximation using Freudenthal triangulation are shown below:</p><p align=center><img src="../figures/function_true.svg" alt="True Function Values" width=600/> <img src="../figures/function_approx.svg" alt="Approximate Function Values" width=600/></p><h2 id="Belief-Space-Interpolation"><a class="docs-heading-anchor" href="#Belief-Space-Interpolation">Belief Space Interpolation</a><a id="Belief-Space-Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Belief-Space-Interpolation" title="Permalink"></a></h2><p>Now if we want to use freudenthal triangulation in belief-state planning, then we need to be able to convert integer vertices in Freudenthal space to form a triangulation of the belief over <span>$n$</span> discrete states. This transformation changes the vertex <span>$v$</span> into</p><p class="math-container">\[v&#39; = \frac{1}{m} [v_1 - v_2, v_2 - v_3, \dots, v_{n-1} - v_n, v_n]\]</p><p>where <span>$v&#39;$</span> represents a valid probability distribution that sums to <span>$1$</span> as <span>$v_1 = m$</span>. The probability assigned to the <span>$i$</span>th state is given by <span>$v&#39;_{i}$</span>.</p><p>The transformation is equivalent to the matrix multiplication <span>$v&#39; = Bv$</span> with</p><p class="math-container">\[B = \frac{1}{m}\begin{bmatrix} 1 &amp; -1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; 1 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 \\ \vdots &amp; &amp; &amp; &amp; &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; &amp; 1 &amp; -1 \\ 0 &amp; 0 &amp; \cdots &amp; &amp; 0 &amp; 1 \end{bmatrix}.\]</p><p>This matrix <span>$B$</span> is invertible so the opposite transformation can be done. Hence any belief <span>$b$</span> can thus be mapped into Freudenthal space to obtain its counterpart <span>$x = B^{-1}b$</span>. It turns out that the <span>$i$</span>th component of <span>$B^{-1}b$</span> is simply <span>$m \sum_{k = i}^n b_k.$</span> Now that we have the ability to convert between belief space and Freudenthal space. We showed above how to interpolate in Freudenthal space with integer simplex vertices. To interpolate in belief spac,e we simply use the transformation to the belief space. Suppose we know the values <span>$\mathcal{U}(b)$</span> at all of the vertices <span>$v&#39;$</span> in the belief triangulation. Given any new belief <span>$b$</span> we can compute <span>$x = B^{-1}b$</span>, find the vertices <span>$v^{(1)}, v^{(2)}, \dots, v^{(n+1)}$</span> of the corresponding simplex in the original Freudenthal triangulation and then compute the barycentric coordinates <span>$\lambda = (\lambda_1, \lambda_2, \dots, \lambda_{n+1})$</span> for <span>$x.$</span> The interpolate value is then:</p><p class="math-container">\[\mathcal{U}(b) = \sum_{i=1}^{n+1} \lambda_i \mathcal{U}(v&#39;^{(i)}) = \sum_{i = 1}^{n+1} \lambda_i \mathcal{U}(Bv^{(i)}).\]</p><p>We can iteratively apply backups over our beliefs in <span>$B$</span> using one-step lookahead with our belief value function interpolation to get an upper bound on the value. If <span>$\mathcal{U}$</span> is initialized with an upper bound, value iteration will result in an upper bound even after a finite number of iterations.</p><h2 id="Example-of-Freudenthal-Discretization-of-a-Belief-Space"><a class="docs-heading-anchor" href="#Example-of-Freudenthal-Discretization-of-a-Belief-Space">Example of Freudenthal Discretization of a Belief Space</a><a id="Example-of-Freudenthal-Discretization-of-a-Belief-Space-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-Freudenthal-Discretization-of-a-Belief-Space" title="Permalink"></a></h2><p>We saw that the Freudenthal discretization of a belief space over <span>$3$</span> states with <span>$m=3$</span> has <span>$10$</span> vertices</p><p class="math-container">\[\begin{Bmatrix} [3,0,0] &amp; [3,1,0] &amp; [3,2,0] &amp; [3,3,0] \\  &amp; [3,1,1] &amp; [3,2,1] &amp; [3,3,1] \\ &amp; &amp; [3,2,2] &amp; [3,3,2] \\ &amp; &amp; &amp; [3,3,3] \end{Bmatrix}\]</p><p>We have the same triangulation mapped to the <span>$3$</span>-state belief space. These vertices are:</p><p class="math-container">\[\begin{Bmatrix} [1,0,0] &amp; [2/3, 1/3, 0] &amp; [1/3, 2/3, 0] &amp; [0, 1, 0] \\  &amp; [2/3, 0, 1/3] &amp; [1/3, 1/3, 1/3] &amp; [0, 2/3, 1/3] \\ &amp; &amp; [1/3, 0, 2/3] &amp; [0, 1/3, 2/3] \\ &amp; &amp; &amp; [0, 0, 1] \end{Bmatrix}\]</p><p>Since the first component of every vertex is <span>$m.$</span> The other two dimensions, along with the projected triangulation, are shown in the image below.</p><p align=center><img src="../figures/ft_belief_triangulations.svg" alt="Freudenthal Triangulation Belief Triangulation" width=600/></p><h2 id="Example-of-Policy-and-Value-Function-for-Manufacture-Problem"><a class="docs-heading-anchor" href="#Example-of-Policy-and-Value-Function-for-Manufacture-Problem">Example of Policy and Value Function for Manufacture Problem</a><a id="Example-of-Policy-and-Value-Function-for-Manufacture-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-Policy-and-Value-Function-for-Manufacture-Problem" title="Permalink"></a></h2><p>The policy and value function for the maintenance problem with granularity <span>$m = 10$</span> after <span>$11$</span> iterations. The value function plot shows the discrete belief points as white dots. This policy approximates the exact policy given in appendix F of Algorithms for Decision Making.</p><p align=center><img src="../figures/policytriangulation.svg" alt="Policy Triangulation" width=375/> <img src="../figures/valuetriangulation.svg" alt="Value Triangulation" width=325/></p><p>[1] <a href="https://algorithmsbook.com/"><em>Algorithms for Decision Making</em></a> by Mykel J. Kochenderfer, Tim A. Wheeler, Kyle H. Wray, MIT Press, 2022</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Usage</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 16 April 2021 01:50">Friday 16 April 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
